# php3 lesson2

1. Берем фреймворк laravel 5.5. В качестве БД возьмем sqlite3. Файл базы squlate будет лежать на уровень выше нашей временной папки проекта.
В конфиге config/datebase путь/имя Б.Д. указывается относительно корневой директории проекта. Т.е. в файле .env (откуда берутся данные для подстановки в конфиг) напротив DB_DATABASE
указываем путь ../datebase/php.sqlite. На всякий случай копия этого файла лежит в директории datebase проекта.
   
2.  В файле build/build.xml проекта собираем наш проект, но пока без миграций:
    - под запретом копирования оказываются помимо папки vendor и build еще и несколько файлов и папок самого laravel (которые также находятся в gitignore), среди них
    файл .env. Этот файл для каждой машины должен быть свой. Вместо передачи этого файла мы уже после копирования на сервер возьмем файл .env.example, где уже предварительно проставлены токены напротив нужных нам "констант".
    А сам файл в процессе копирования будет переменован в .env. Обращаю внимание, что относительно директории сборки папка с базой будет находиться уже на 2 уровня выше: ../../datebase/php.sqlite
    
    Собираем проект:
     
    ```php build/phing.phar -f build/build.xml``` 
    
    Все получилось. Проект скопировался, композер собрался, кофигурационные данные были заменены в новом файле .env в папке public_html был заменен симлинк.

3. Создаем файлы миграций:
    ```php artisan make:migration create_users_table```
    ```php artisan make:migration create_roles_table```
    
    Файлы созданы, во втором файле помимо таблицы roles создадим еще таблицу user_role, которая является pivot таблицей, для назначения ролей пользователям. 
    Помимо создания таблиц в файлах миграций добавлен код заполнения этих таблиц первичными данными - один пользователь, две роли и в промежуточную таблицу добавили строку для назначения нашему единственному пользователю роли admin.
    
    Пробуем применить:

```php artisan migrate```

Все применилось. Пробуем откатить:

```php artisan migrate:rollback```

Так же успешно.

4. В файл build.xml добавим новую цель: migration. Собираем проект:

```php build/phing.phar -f build/build.xml```

Все применилось.

